<!-- CHANGELOG/20251117203035.md -->
# Transformação White Label - Etapa 3: Refatoração de Componentes React

**Data/Hora UTC:** 2025-11-17 20:30:35  
**Tipo:** Transformação arquitetural  
**Escopo:** Refatoração completa de componentes React para white label

## Arquivos Modificados

### Componentes React
- `app/ui/src/components/OfferCard.tsx` - Refatorado para usar tipo `Offer` ao invés de `LoteResiduo`, props atualizadas de `lote` para `offer`, rotas atualizadas para `/offers/:id`
- `app/ui/src/pages/ListarLotesPage.tsx` - Atualizado para usar `Offer[]`, variáveis renomeadas de `lotes` para `offers`, endpoint atualizado para `/app/api/offers`, placeholder de busca atualizado
- `app/ui/src/pages/DetalhesLotePage.tsx` - Refatorado para usar `Offer`, variáveis renomeadas, textos atualizados ("lote" → "produto", "oferta"), compatibilidade com endpoints legacy
- `app/ui/src/pages/LoginPage.tsx` - Redirecionamentos atualizados de `/lotes` para `/offers`
- `app/ui/src/pages/CriarLotePage.tsx` - Endpoint atualizado com fallback para compatibilidade
- `app/ui/src/components/SelledTab.tsx` - Refatorado para usar `Offer[]`, textos atualizados, endpoint com fallback
- `app/ui/src/components/PurchasedTab.tsx` - Refatorado para usar `Offer[]`, textos atualizados, endpoint com fallback
- `app/ui/src/components/TransacaoCard.tsx` - Compatibilidade com `offer` e `lote_residuo` legacy
- `app/ui/src/components/BottomNavigation.tsx` - Rotas atualizadas para `/offers` e `/offers/novo`
- `app/ui/src/App.tsx` - Rotas principais atualizadas para `/offers`, rotas legacy mantidas para compatibilidade

## Requisitos e Regras Atendidas

### Requisitos RUP
- Mantidos todos os IDs de requisitos (REQ-###) intactos
- Funcionalidades preservadas com terminologia genérica

### Regras Globais do Projeto
- **AGENTS.md - Política de CHANGELOGs obrigatórios:** Changelog criado
- **AGENTS.md - Convenções de código:** Compatibilidade mantida com tipos legacy via type casting
- **AGENTS.md - Princípios DRY:** Reutilização de componentes mantida

### Regras Específicas da Transformação
- **Neutralidade de domínio:** Todos os textos visíveis ao usuário atualizados
- **Modularidade:** Componentes genéricos mantidos
- **Traçabilidade RUP:** Mudanças documentadas

## Compatibilidade e Fallbacks

### Estratégia de Compatibilidade
- **Tipos TypeScript:** Componentes usam `Offer` mas mantêm compatibilidade com `LoteResiduo` via type casting `(offer as any).titulo`
- **Endpoints API:** Tentativa de `/offers` primeiro, fallback para `/lotes` quando necessário
- **Rotas:** Rotas principais atualizadas para `/offers`, rotas legacy `/lotes` redirecionam ou mantêm compatibilidade

### Textos Atualizados
- "lote" / "lotes" → "produto" / "produtos" / "oferta" / "ofertas"
- "material" → "produto" (em placeholders de busca)
- Mensagens de erro e estados vazios atualizados

## Pendências e Próximos Passos

### Componentes que Ainda Podem Precisar de Ajustes
- [ ] `CriarLotePage.tsx` - Pode precisar de atualização de textos e labels de formulário
- [ ] `TransacaoPage.tsx` - Verificar se há referências a "lote" em textos
- [ ] `StatementPage.tsx` - Verificar se há referências específicas ao domínio anterior
- [ ] Componentes de skeleton e loading podem ter nomes de variáveis legados

### Backend
- [ ] Atualizar endpoints da API de `/lotes` para `/offers` (quando backend estiver pronto)
- [ ] Atualizar DTOs e entidades do backend para usar terminologia genérica
- [ ] Migrar rotas do backend mantendo compatibilidade

### Validação Final
- [ ] Executar testes E2E para validar fluxos completos
- [ ] Validar que rotas legacy funcionam corretamente
- [ ] Verificar que fallbacks de API funcionam como esperado

## Referências Cruzadas

- **Plano de execução:** `docs/rup/99-anexos/MVP/plano-white-label.md`
- **Mapeamento de termos:** `docs/rup/99-anexos/reference/mapeamento-white-label.md`
- **Changelogs anteriores:** 
  - `CHANGELOG/20251117202543.md` (Etapa 1)
  - `CHANGELOG/20251117202715.md` (Etapa 2)

## Observações

- Refatoração mantém compatibilidade total com backend legacy através de fallbacks
- Tipos TypeScript mantêm compatibilidade via type casting quando necessário
- Rotas legacy mantidas para não quebrar links existentes ou bookmarks
- Componentes agora usam terminologia genérica mas funcionam com dados legacy
- Próxima etapa deve focar em atualização do backend para completar a transformação

